---
title: "R Notebook"
output: html_notebook
---





#Comparing two maps in GUI and code-based environments


The idea behind these studies comes to produce two maps using the POLICE.UK street-crimes data (https://data.police.uk/). The first spatial representation consists in comparing the street crimes and the Underground Stations location, the second takes into consideration the difference of street-crimes in two different months in London. 

For this purpose the “Police.uk” web-site provides a large quantity of data in CSV format with x,y coordinates . Particularly in this case, the London Metropolitan Police service was used to download the csv file which is released monthly from September 2015 to August 2018. According to the methodology chose by authors, the file describes “individual crime and anti-social behaviour (ASB) incidents, including street-level location information and subsequent police and court”(https://data.police.uk/about/#columns). Along with the Police data, other Open Street Map shapefiles were downloaded from the related Geofabrik website (https://download.geofabrik.de/) as of 1st October 2018 and used as cartographic base for the overall process.


##Visualizing The London Metropolitan Police street-crimes data compared to the Underground Stations location as August 2018. 


The first map is produced using the QGIS GUI based-approach adding different OSM shapefiles within the London area. After importing the Metropolitan Police cvs table and transforming it into points layer (point_crime),  a brand new table has been created through the distance matrix analysis (Vector>Analysis Tools>Distance Matrix). 
The new “Distance matrix.csv” then has been joined with the previous “point_crime.shp” file with properties>joins. This passage was required in order to create the hub line analysis (downloading the MMQGIS plug-in). 
The maps shows the connections that London stations have due their proximity to crime records, according to the Linear(N*k x 3) previously used during the matrix creation. 


## Vizualising the street-crime rate between 2015-2018

The second map is using ther code-based environment in RStudio and takes into consideration the Metropolitan Police street-crime records trend for the July-August 2018 period.

inut the two csv files

```{r}


library(tidyverse)
library(sf)
library(sp)
library(raster)
library(maptools)
library(RColorBrewer)
library(classInt)
library(OpenStreetMap)
library(rgeos)
library(tmap)
library(tmaptools)
library(sf)
library(rgdal)
library(geojsonio)

SC08_18 <- read.csv("C:\\Users\\Bogdan\\Documents\\UCL\\MRes\\GIS\\week4\\AssessmentPart1\\DataInput\\data crime London\\278f379b19290400f4123e740fc18bae2bc00ae4\\2018-08\\2018-08-city-of-london-street.csv", header=TRUE, sep = ",")



SC07_18 <- read.csv("C:\\Users\\Bogdan\\Documents\\UCL\\MRes\\GIS\\week4\\AssessmentPart1\\DataInput\\data crime London\\278f379b19290400f4123e740fc18bae2bc00ae4\\2018-07\\2018-07-city-of-london-street.csv", header=TRUE, sep = ",")

names(SC08_18)
names(SC07_18)
class(SC08_18)
class(SC07_18)
str(SC07_18)
plot(SC07_18$Location)




```


##PLace the CRS to the 2 tables:

```{r}
##taking the reference from: http://www.spatialreference.org/ref/epsg/32622/
 
# convert the dataframes to  objects:
SC07_18_sp <- st_as_sf(SC07_18, coords= c("Latitude", "Longitude"), crs= " +proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")


SC08_18_sp <- st_as_sf(SC08_18, coords= c("Latitude", "Longitude"), crs= " +proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")

crs(SC07_18_sp)


```


##Convert the two tables in shapefiles:
```{r}

#EXport the obejcts as shapefiles:
st_write(SC07_18_sp,"C:\\Users\\Bogdan\\Documents\\UCL\\MRes\\GIS\\week4\\AssessmentPart1\\DataOutput\\Crimes07_18.shp", driver="ESRI shapefile")

st_write(SC08_18_sp,"C:\\Users\\Bogdan\\Documents\\UCL\\MRes\\GIS\\week4\\AssessmentPart1\\DataOutput\\Crimes08_18.shp", driver="ESRI shapefile")


```
 
 
 
## Insert and reading the base shape files:
 
```{r}

Points_Crime<- read_shape("C:\\Users\\Bogdan\\Documents\\UCL\\MRes\\GIS\\week4\\AssessmentPart1\\DataOutput\\Crimes08_18.shp",as.sf=TRUE)

COL_buldings<- read_shape("C:\\Users\\Bogdan\\Documents\\UCL\\MRes\\GIS\\week4\\AssessmentPart1\\DataOutput\\CLA_buildings.shp",as.sf=TRUE)

qtm(COL_buldings)
```
 



